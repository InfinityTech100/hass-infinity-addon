<div id="new-device-panel" class="hidden">
  <div class="container mx-auto p-4 flex flex-col space-y-4">
    <h1 class="text-4xl flex items-center space-x-1">
      <i class="material-icons">devices_other</i>
      <span>New Device</span>
    </h1>

    <label class="my-2">Device Name</label>
    <input
      type="text"
      placeholder="Enter your Device Name here"
      class="input input-bordered w-full mt-1"
    />

    <label class="my-2">Cloud Dashboard ID</label>
    <input
      type="text"
      placeholder="Enter your cloud id for this device here"
      class="input input-bordered w-full mt-1"
    />

    <label class="form-control w-full">
      <div class="label">
        <span class="label-text">Device Source</span>
      </div>
      <select id="source" class="select select-bordered w-full mt-1">
        <option disabled selected>select source</option>
        <option>zigbee2mqtt</option>
        <option>Home-Hub</option>
      </select>
      <div class="label">
        <span class="label-text-alt">interface</span>
      </div>
    </label>

    <div id="property-mapping" class="">
      <div class="container mx-auto p-4">
        <h1 class="text-4xl mb-4">Properties Mapping</h1>

        <div class="mb-4">
          <button class="btn btn-primary" onclick="addRow()">
            Add property
          </button>
        </div>

        <table class="table-auto w-full" id="dynamicTable">
          <thead>
            <tr class="">
              <th class="px-4 py-2">Property Name</th>
              <th class="px-4 py-2">Attribute</th>
              <th class="px-4 py-2">Actions</th>
            </tr>
          </thead>
          <tbody>
            <!-- Dynamic rows will be added here -->
          </tbody>
        </table>
      </div>
    </div>

    <button class="btn btn-primary mt-5 self-end" onclick="logTableValues()">
      Add
    </button>
  </div>
</div>

<script>
  function addRow() {
    const table = document
      .getElementById("dynamicTable")
      .getElementsByTagName("tbody")[0];
    const newRow = table.insertRow();

    const cell1 = newRow.insertCell(0);
    const cell2 = newRow.insertCell(1);
    const cell3 = newRow.insertCell(2);

    cell1.innerHTML =
      '<input type="text" class="input  w-full" placeholder="Enter property name">';
    cell2.innerHTML = `
        <select class="select select-bordered w-full">
          <option value="attribute1">Attribute 1</option>
          <option value="attribute2">Attribute 2</option>
          <option value="attribute3">Attribute 3</option>
        </select>`;
    cell3.innerHTML =
      '<div class="flex justify-center"><button class="btn btn-danger" onclick="deleteRow(this)">Delete</button></div>';
  }

  function deleteRow(button) {
    const row = button.parentNode.parentNode.parentNode;
    row.parentNode.removeChild(row);
  }

  function logTableValues() {
    const table = document.getElementById("dynamicTable");
    const rows = table
      .getElementsByTagName("tbody")[0]
      .getElementsByTagName("tr");

    for (let i = 0; i < rows.length; i++) {
      const cells = rows[i].getElementsByTagName("td");
      const propertyName = cells[0].getElementsByTagName("input")[0].value;
      const attribute = cells[1].getElementsByTagName("select")[0].value;

      console.log(
        `Row ${
          i + 1
        }: Property Name = ${propertyName}, Attribute = ${attribute}`
      );
    }
  }
</script>

<script>
  document.getElementById("source").addEventListener("change", function () {
    const selectedValue = this.value;
    let x = document.getElementById("property-mapping");
    if (selectedValue === "Home-Hub") {
      console.log("show props");
      x.className = "";
    } else {
      console.log("dont");
      x.className = "hidden";
    }
  });
</script>
